services:
  telegram-bot-api:
    image: aiogram/telegram-bot-api:latest
    container_name: telegram_api_server
    restart: always
    environment:
      # Докер сам возьмет эти значения из .env файла
      TELEGRAM_API_ID: ${TELEGRAM_API_ID}
      TELEGRAM_API_HASH: ${TELEGRAM_API_HASH}
      TELEGRAM_LOCAL: "true"
      TELEGRAM_STAT: "true"
    volumes:
      - telegram_data:/var/lib/telegram-bot-api
    # Порты можно оставить, они не секретны
    ports:
      - "8081:8081"

  bot:
    build: .
    container_name: video_bot
    restart: always
    env_file:
      - .env
    volumes:
      - ./bot_database.db:/app/bot_database.db
      - ./instagram_cookies.txt:/app/instagram_cookies.txt
      - ./youtube_cookies.txt:/app/youtube_cookies.txt
      - telegram_data:/var/lib/telegram-bot-api
    depends_on:
      - telegram-bot-api

volumes:
  telegram_data:
